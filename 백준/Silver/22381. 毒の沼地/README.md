# [Silver III] 毒の沼地 - 22381 

[문제 링크](https://www.acmicpc.net/problem/22381) 

### 성능 요약

메모리: 111276 KB, 시간: 164 ms

### 분류

기하학, 그래프 이론, 수학

### 제출 일자

2024년 1월 28일 22:24:23

### 문제 설명

<p>あなたはレトロなロールプレイングゲームで遊んでいる．このゲームのフィールドは縦 100 マス，横 100 マスのマス目状である．このフィールドの左から <i>x</i> 列目，上から <i>y</i> 行目のマスは <i>(x, y)</i> と表される．あなたが操作するキャラクターはフィールド内のいずれかのマスの上におり，フィールド内を上下左右に 1 マスずつ移動することができる．</p>

<p>あなたが操作するキャラクターはいま <i>(X<sub>0</sub>, Y<sub>0</sub>)</i> にいて，これから <i>N</i> 箇所の目的地を順番に訪問する予定である．しかしながら，あなたはキャラクターを操作するとき，フィールドのマスの種類に注意してキャラクターを移動させなければならない．それぞれのマスは毒のある沼地か毒のない土地のどちらかである．キャラクターの移動先のマスが毒のある沼地の場合にはキャラクターはダメージを受け，移動先のマスが毒のない土地の場合にはダメージを受けない．あなたはキャラクターへのダメージを減らすため，適切に経路を選ぶことでキャラクターがダメージを受ける回数をできるだけ少なくしたい．ダメージの有無はキャラクターの移動先のマスの種類で決まること，例として，移動元のマスが毒のある沼地で移動先のマスが毒のない土地の場合にはキャラクターはダメージを受けないことに注意せよ．</p>

<p>あなたの分析によれば，左上を <i>(A, B)</i> ，右下を <i>(C, D)</i> とする長方形の範囲内のマスは毒のない土地であり，それ以外のマスは毒のある沼地である．あなたのキャラクターが毒のある沼地からダメージを受ける回数を最小化するように <i>N</i> 箇所の目的地を順番に訪問したとき，あなたの操作するキャラクターがダメージを受ける回数を求めよ．</p>

### 입력 

 <p>入力は最大で 50 個のデータセットからなる． 各データセットは次の形式で表される．</p>

<pre><i>N</i>
<i>A</i> <i>B</i> <i>C</i> <i>D</i>
<i>X<sub>0</sub></i> <i>Y<sub>0</sub></i>
<i>X<sub>1</sub></i> <i>Y<sub>1</sub></i>
<i>X<sub>2</sub></i> <i>Y<sub>2</sub></i>
<i>...</i>
<i>X<sub>N</sub></i> <i>Y<sub>N</sub></i></pre>

<p>データセットは <i>N+3</i> 行からなる．</p>

<p>1 行目は目的地の数 <i>N</i> (<i>1 ≤ N ≤ 100</i>) を表す整数である．</p>

<p>2 行目は毒のない土地となっている長方形の範囲を表す整数 <i>A</i>，<i>B</i>，<i>C</i>，<i>D</i> であり，<i>1 ≤ A ≤ C ≤ 100</i>，<i>1 ≤ B ≤ D ≤ 100</i> を満たす．キャラクターの移動先のマス <i>(x, y)</i> が <i>A ≤ x ≤ C</i> と <i>B ≤ y ≤ D</i> を満たすとき，またその場合に限りキャラクターはダメージを受けない．</p>

<p>3 行目はあなたが操作するキャラクターが最初にいるマスの座標 <i>(X<sub>0</sub>, Y<sub>0</sub>)</i> を表す整数であり <i>1 ≤ X<sub>0</sub>, Y<sub>0</sub> ≤ 100</i> を満たす．4 行目から続く <i>N</i> 行には <i>N</i> 箇所の目的地の座標が与えられる．<i>3+i</i> 行目は <i>i</i> 番目の目的地のマスの座標 <i>(X<sub>i</sub>, Y<sub>i</sub>)</i> を表す整数であり <i>1 ≤ X<sub>i</sub>, Y<sub>i</sub> ≤ 100</i> を満たす．キャラクターが最初にいるマスおよび目的地のマスの座標はそれぞれ異なる，すなわち <i>(X<sub>j</sub>, Y<sub>j</sub>) ≠ (X<sub>k</sub>, Y<sub>k</sub>)</i> <i>(0 ≤ j < k ≤ N)</i> を満たす．</p>

<p>入力の終わりは，1 個のゼロだけからなる行で表される．</p>

### 출력 

 <p>各データセットについて，あなたの操作するキャラクターがダメージを受ける回数を 1 行で出力せよ．</p>

