import sys
input = sys.stdin.readline
g = lambda: [*map(int, input().split())]

tetrominos = (
    (),
    (((0, 0), (1, 0), (1, 1), (2, 1)), ((0, 1), (0, 2), (1, 0), (1, 1)), ((0, 0), (1, 0), (1, 1), (2, 1)), ((0, 1), (0, 2), (1, 0), (1, 1))),
    (((0, 1), (1, 0), (1, 1), (2, 0)), ((0, 0), (0, 1), (1, 1), (1, 2)), ((0, 1), (1, 0), (1, 1), (2, 0)), ((0, 0), (0, 1), (1, 1), (1, 2))),
    (((0, 0), (1, 0), (2, 0), (2, 1)), ((0, 2), (1, 0), (1, 1), (1, 2)), ((0, 0), (0, 1), (1, 1), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 0))),
    (((0, 1), (1, 1), (2, 0), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 2)), ((0, 0), (0, 1), (1, 0), (2, 0)), ((0, 0), (1, 0), (1, 1), (1, 2))),
    (((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1))),
    (((0, 0), (1, 0), (2, 0), (3, 0)), ((0, 0), (0, 1), (0, 2), (0, 3)), ((0, 0), (1, 0), (2, 0), (3, 0)), ((0, 0), (0, 1), (0, 2), (0, 3))),
    (((0, 1), (1, 0), (1, 1), (1, 2)), ((0, 1), (1, 0), (1, 1), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 1)), ((0, 0), (1, 0), (1, 1), (2, 0)))
)

for tc in range(1, 1 + int(input())):
    W, H, N = g()
    board = [['.' for _ in range(W)] for _ in range(H)]
    ans = ""
    for _ in range(N):
        t, r, x = g()
        tetromino = [(a, b + x) for a, b in tetrominos[t][r]]
        l, i = tetromino[3][0], 0
        while i + l < H:
            if all(board[i + a][b] == '.' for a, b in tetromino):
                i += 1
            else:
                break
        i -= 1
        if i == -1:
            for __ in range(N - _ - 1):
                input()
            ans = "Game Over!"
            break
        for a, b in tetromino:
            board[i + a][b] = 'x'
        for j in range(H):
            if all(board[j][b] == 'x' for b in range(W)):
                board.pop(j)
                board.insert(0, ['.'] * W)
    if ans != "Game Over!":
        ans = "\n".join("".join(row) for row in board)
    print(f"Case #{tc}:\n{ans}")
    tc += 1