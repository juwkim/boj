import sys
input = sys.stdin.readline
tetrominos = (
    (),
    (((0, 0), (1, 0), (1, 1), (2, 1)), ((0, 1), (0, 2), (1, 0), (1, 1)), ((0, 0), (1, 0), (1, 1), (2, 1)), ((0, 1), (0, 2), (1, 0), (1, 1))),
    (((0, 1), (1, 0), (1, 1), (2, 0)), ((0, 0), (0, 1), (1, 1), (1, 2)), ((0, 1), (1, 0), (1, 1), (2, 0)), ((0, 0), (0, 1), (1, 1), (1, 2))),
    (((0, 0), (1, 0), (2, 0), (2, 1)), ((0, 2), (1, 0), (1, 1), (1, 2)), ((0, 0), (0, 1), (1, 1), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 0))),
    (((0, 1), (1, 1), (2, 0), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 2)), ((0, 0), (0, 1), (1, 0), (2, 0)), ((0, 0), (1, 0), (1, 1), (1, 2))),
    (((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1)), ((0, 0), (0, 1), (1, 0), (1, 1))),
    (((0, 0), (1, 0), (2, 0), (3, 0)), ((0, 0), (0, 1), (0, 2), (0, 3)), ((0, 0), (1, 0), (2, 0), (3, 0)), ((0, 0), (0, 1), (0, 2), (0, 3))),
    (((0, 1), (1, 0), (1, 1), (1, 2)), ((0, 1), (1, 0), (1, 1), (2, 1)), ((0, 0), (0, 1), (0, 2), (1, 1)), ((0, 0), (1, 0), (1, 1), (2, 0)))
)

for tc in range(1, 1 + int(input())):
    W, H, N = map(int, input().split())
    Map = [['.' for _ in range(W)] for _ in range(H)]
    win = True
    for _ in range(N):
        t, r, x = map(int, input().split())
        tetromino = [(a, b + x) for a, b in tetrominos[t][r]]
        l, i = tetromino[3][0], 0
        while i + l < H:
            if all(Map[i + a][b] == '.' for a, b in tetromino):
                i += 1
            else:
                break
        i -= 1
        if i == -1:
            for __ in range(N - _ - 1):
                input()
            win = False
            break
        for a, b in tetromino:
            Map[i + a][b] = 'x'
        for j in range(H):
            if all(Map[j][b] == 'x' for b in range(W)):
                Map.pop(j)
                Map.insert(0, ['.'] * W)
    if win:
        ans = "\n".join("".join(row) for row in Map)
    else:
        ans = "Game Over!"
    print(f"Case #{tc}:\n{ans}")
    tc += 1